{% extends "main.htm" %}

{% block body %}
    <div id='filter'>
        <div class='csectionone'>
            <form method='post' action='/nightly/query'>
                <table class='deviceselect'>
                    <tr>
                        <th>IA Phone</th>
                        <th>ARM Phone</th>
                        <th>IA Tablet</th>
                        <th>ARM Tablet</th>
                        <th>IVI Laptop NUC</th>
                    </tr>
                    <tr>
                        <td>
                            {% for device in devices %}
                                {% if device.platform.lower() == 'android' and device.architecture.lower() == 'ia' and device.type.lower() == 'phone' %}
                                    <input name="id_{{ device.id }}" type="checkbox" value="{{ escape(device.name) }}" class="cbselector"> {{ escape(device.name) }}<br/>
                                {% end %}
                            {% end %}                        
                        </td>
                        <td>
                            {% for device in devices %}
                                {% if device.platform.lower() == 'android' and device.architecture.lower() == 'arm' and device.type.lower() == 'phone' %}
                                    <input name="id_{{ device.id }}" type="checkbox" value="{{ escape(device.name) }}" class="cbselector"> {{ escape(device.name) }}<br/>
                                {% end %}
                            {% end %}                     
                        </td>
                        <td>
                            {% for device in devices %}
                                {% if device.platform.lower() == 'android' and device.architecture.lower() == 'ia' and device.type.lower() == 'tablet' %}
                                    <input name="id_{{ device.id }}" type="checkbox" value="{{ escape(device.name) }}" class="cbselector"> {{ escape(device.name) }}<br/>
                                {% end %}
                            {% end %} 
                        </td>
                        <td>
                            {% for device in devices %}
                                {% if device.platform.lower() == 'android' and device.architecture.lower() == 'arm' and device.type.lower() == 'tablet' %}
                                    <input name="id_{{ device.id }}" type="checkbox" value="{{ escape(device.name) }}" class="cbselector"> {{ escape(device.name) }}<br/>
                                {% end %}
                            {% end %} 
                        </td>
                        <td>
                            {% for device in devices %}
                                {% if device.platform.lower() == 'tizen'%}
                                    <input name="id_{{ device.id }}" type="checkbox" value="{{ escape(device.name) }}" class="cbselector"> {{ escape(device.name) }}<br/>
                                {% end %}
                            {% end %} 
                        </td>
                    </tr>
                </table>
                <input id='btquery' type='submit' text='Query' value='Query'>        
            </form>
        </div>
    </div>
    <article>
        <div id='distype'>
            <ul id='tog' class='notdisplay'>
                <li id='chart'>Chart</li>
                <li id='data'>Data</li>
            </ul>
            <ul id='ind'>
                <li id='plus'>+</li>
                <li id='updown'>&uarr;</li>        
            </ul>
        </div>   
            <script type="text/javascript">
                $(function () {
                        $('#container_{{ l[0][0].profile }}').highcharts({
                            title: {
                                text: 'Nightly Test on {{ l[0][0].profile }} Pass Rates (%)',
                                x: -20 //center
                            },
                            subtitle: {
                                text: 'Source: http://wrt-qa-report.sh.intel.com/v2/{{ l[0][0].profile }}/{% if (l[0][0].darchitecture.lower() =="common") or (l[0][0].darchitecture.lower() =="generic") %}Tizen {%end%}{{ l[0][0].darchitecture }} {{ l[0][0].branch }}/{{ l[0][0].hardware }}',
                                x: -20
                            },
                            xAxis: {
                                categories: [
                                        {% for list in l[::-1] %}
                                            {% for lv in list[::-1] %}
                                             '{{ lv.build_id }}', 
                                            {% end %}
                                        {% end %}
                                ]
                            },
                            yAxis: {
                                title: {
                                    text: 'Pass Rate (%)'
                                },
                                min: 60,
                                max: 100,
                                plotLines: [{
                                    value: 0,
                                    width: 1,
                                }]
                            },
                            tooltip: {
                                valueSuffix: '%'
                            },
                            legend: {
                                layout: 'vertical',
                                align: 'right',
                                verticalAlign: 'middle',
                                borderWidth: 0
                            },
                            series: [
                            {% for list in l[::-1] %}
                            {
                                name: '{{list[0].name}}',
                                type: 'spline',
                                data: [
                                    {% for lv in list[::-1] %}
                                     {{ round(float(lv.total_pass)*100/lv.total_cases, 0) }}, 
                                    {% end %}
                                ]
                            },
                            {% end %}]
                        });
                    });
            </script>
            <div id="container_{{ l[0][0].profile }}" style="max-width: 800px; height: 400px; margin: 0 auto"></div>
            {% for list in l[::-1] %}
                        <h5><a href='nightly/{{ list[0].device }}' title='{{ l[0][0].profile }} {{ l[0][0].architecture }} / {{ l[0][0].branch }} / {{l[0][0].name }}'>{{ l[0][0].profile }} {{ l[0][0].architecture }} / {{ l[0][0].branch }} / {{ l[0][0].name }}</a></h5>
            <table class="reports">
                <tr>
                    <th></th>
                    {% for lv in list[::-1] %}
                    <th><a href='http://wrt-qa-report.sh.intel.com/v2/{{ lv.profile }}/{% if (lv.darchitecture.lower() =="common") or (lv.darchitecture.lower() =="generic") %}Tizen {%end%}{{ lv.darchitecture }} {{ lv.branch }}/{{ lv.hardware }}/{{ lv.qa_id }}'>{{escape(lv.build_id)}}</a></th>
                    {% end %}
                    <th>+/-</th>
                </tr>
                <tr>
                    <td>Total TC</td>
                    {% for lv in list[::-1] %}
                    <td>{{ lv.total_cases }}</td>
                    {% end %}
                    <td class='{% if list[0].total_cases - list[1].total_cases < 0 %}{% if list[0].total_cases - list[1].total_cases < 300 %}very{% end %} down{% else %}up{% end %}'>
                    {{ list[0].total_cases - list[1].total_cases }}</td>
                </tr>
                <tr>
                    <td>Passed</td>
                    {% for lv in list[::-1] %}
                    <td>{{ lv.total_pass }}</td>
                    {% end %}
                    <td class='{% if  list[0].total_pass - list[1].total_pass < 0 %}{% if list[0].total_pass - list[1].total_pass < 300 %}very{% end %} down{% else %}up{% end %}'>
                    {{ list[0].total_pass - list[1].total_pass }}</td>
                </tr>
                <tr>
                    <td>Failed</td>
                    {% for lv in list[::-1] %}
                    <td>{{ lv.total_fail }}</td>
                    {% end %}
                    <td class='{% if  list[0].total_fail - list[1].total_fail <= 0 %}up{% else %}down{% end %}'>
                    {{ list[0].total_fail - list[1].total_fail }}</td>
                </tr>
                <tr>
                    <td>Blocked</td>
                    {% for lv in list[::-1] %}
                    <td>{{ lv.total_na }}</td>
                    {% end %}
                    <td class='{% if  list[0].total_na - list[1].total_na <= 0 %}up{% else %}down{% end %}'>
                    {{list[0].total_na - list[1].total_na}}</td>
                </tr>
                <tr>
                    <td>Pass rate</td>
                    {% for lv in list[::-1] %}
                    <td>{{ format(float(lv.total_pass)/lv.total_cases, '.0%') }}</td>
                    {% end %}
                    <td class='{% if  float(list[0].total_pass)/list[0].total_cases  - float(list[1].total_pass)/list[1].total_cases < 0 %}down{% else %}up{% end %}'>
                    {{ format(float(list[0].total_pass)/list[0].total_cases - float(list[1].total_pass)/list[1].total_cases, '.1%') }}</td>
                </tr>
            </table> 

            {% end %}

            <script type="text/javascript">
                $(function () {
                        $('#container_{{ t[0][0].profile }}').highcharts({
                            title: {
                                text: 'Nightly Test on {{ t[0][0].profile }} Pass Rates (%)',
                                x: -20 //center
                            },
                            subtitle: {
                                text: 'Source: http://wrt-qa-report.sh.intel.com/v2/{{ t[0][0].profile }}/{% if (t[0][0].darchitecture.lower() =="common") or (t[0][0].darchitecture.lower() =="generic") %}Tizen {%end%}{{ t[0][0].darchitecture }} {{ t[0][0].branch }}/{{ t[0][0].hardware }}',
                                x: -20
                            },

                            xAxis: {
                                categories: [
                                        {% for list in t[::-1] %}
                                            {% for lv in list[::-1] %}
                                             '{{ lv.build_id }}', 
                                            {% end %}
                                        {% end %}
                                ]
                            },
                            yAxis: {
                                title: {
                                    text: 'Pass Rate (%)'
                                },
                                min: 60,
                                max: 100,
                                plotLines: [{
                                    value: 0,
                                    width: 1,
                                }]
                            },
                            tooltip: {
                                valueSuffix: '%'
                            },
                            legend: {
                                layout: 'vertical',
                                align: 'right',
                                verticalAlign: 'middle',
                                borderWidth: 0
                            },
                            series: [
                            {% for list in t[::-1] %}
                            {
                                name: '{{list[0].name}}',
                                type: 'spline',
                                data: [
                                    {% for lv in list[::-1] %}
                                     {{ round(float(lv.total_pass)*100/lv.total_cases, 0) }}, 
                                    {% end %}
                                ]
                            },
                            {% end %}]
                        });
                    });
            </script>
            <div id="container_{{ t[0][0].profile }}" style="max-width: 800px; height: 400px; margin: 0 auto"></div>
            {% for list in t[::-1] %}
                        <h5><a href='nightly/{{ list[0].device }}' title='{{ t[0][0].profile }} {{ t[0][0].architecture }} / {{ t[0][0].branch }} / {{t[0][0].name }}'>{{ t[0][0].profile }} {{ t[0][0].architecture }} / {{ t[0][0].branch }} / {{ t[0][0].name }}</a></h5>
            <table class="reports">
                <tr>
                    <th></th>
                    {% for lv in list[::-1] %}
                    <th><a href='http://wrt-qa-report.sh.intel.com/v2/{{ lv.profile }}/{% if (lv.darchitecture.lower() =="common") or (lv.darchitecture.lower() =="generic") %}Tizen {%end%}{{ lv.darchitecture }} {{ lv.branch }}/{{ lv.hardware }}/{{ lv.qa_id }}'>{{escape(lv.build_id)}}</a></th>
                    {% end %}
                    <th>+/-</th>
                </tr>
                <tr>
                    <td>Total TC</td>
                    {% for lv in list[::-1] %}
                    <td>{{ lv.total_cases }}</td>
                    {% end %}
                    <td class='{% if list[0].total_cases - list[1].total_cases < 0 %}{% if list[0].total_cases - list[1].total_cases < 300 %}very{% end %} down{% else %}up{% end %}'>
                    {{ list[0].total_cases - list[1].total_cases }}</td>
                </tr>
                <tr>
                    <td>Passed</td>
                    {% for lv in list[::-1] %}
                    <td>{{ lv.total_pass }}</td>
                    {% end %}
                    <td class='{% if  list[0].total_pass - list[1].total_pass < 0 %}{% if list[0].total_pass - list[1].total_pass < 300 %}very{% end %} down{% else %}up{% end %}'>
                    {{ list[0].total_pass - list[1].total_pass }}</td>
                </tr>
                <tr>
                    <td>Failed</td>
                    {% for lv in list[::-1] %}
                    <td>{{ lv.total_fail }}</td>
                    {% end %}
                    <td class='{% if  list[0].total_fail - list[1].total_fail <= 0 %}up{% else %}down{% end %}'>
                    {{ list[0].total_fail - list[1].total_fail }}</td>
                </tr>
                <tr>
                    <td>Blocked</td>
                    {% for lv in list[::-1] %}
                    <td>{{ lv.total_na }}</td>
                    {% end %}
                    <td class='{% if  list[0].total_na - list[1].total_na <= 0 %}up{% else %}down{% end %}'>
                    {{list[0].total_na - list[1].total_na}}</td>
                </tr>
                <tr>
                    <td>Pass rate</td>
                    {% for lv in list[::-1] %}
                    <td>{{ format(float(lv.total_pass)/lv.total_cases, '.0%') }}</td>
                    {% end %}
                    <td class='{% if  float(list[0].total_pass)/list[0].total_cases  - float(list[1].total_pass)/list[1].total_cases < 0 %}down{% else %}up{% end %}'>
                    {{ format(float(list[0].total_pass)/list[0].total_cases - float(list[1].total_pass)/list[1].total_cases, '.1%') }}</td>
                </tr>
            </table> 
        {% end %}
 
        <script type='text/javascript' src='{{ static_url('highcharts/js/highcharts.js') }}'></script>
        <script type='text/javascript' src='{{ static_url('highcharts/js/modules/exporting.js') }}'></script>
        <script type="text/javascript" src='{{ static_url('ui.js') }}'></script>

    </article>
{% end %}

